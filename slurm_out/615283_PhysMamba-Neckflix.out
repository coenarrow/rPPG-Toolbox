Current Working Directory: /group/pgh004/carrow/repo/rPPG-Toolbox
Currently Loaded Modulefiles:
 1) cuda/11.8   2) Anaconda3/2024.06(default)  
Activated Conda Environment
# conda environments:
#
                         /group/pgh004/carrow/repo/MedLLM/PMC-LLaMA/env
                         /group/pgh004/carrow/repo/btseq/env
                         /group/pgh004/carrow/repo/hr_detection/envs/pyvhr
                         /group/pgh004/carrow/repo/hr_detection/envs/sam2
                      *  /group/pgh004/carrow/repo/rPPG-Toolbox/env
rppg-toolbox             /home/carrow/.conda/envs/rppg-toolbox
base                     /uwahpc/centos8/python/Anaconda3/2024.06

Start Time: Wed Feb 12 10:37:03 AWST 2025
Running with PhysMamba
=> Merging a config file from ./configs/neckflix_configs/Neckflix_train_test-PhysMamba.yaml
Number of Recordings Found: 332
Num files after separating by cameras: 986
Num files after filtering by camera mode: 655
Num Files after filtering by label: 627
Starting Preprocessing...
Num Files after splitting by participant: 492
Num Files after removing already processed: 5
Preprocessing dataset...
Total Number of raw files preprocessed: 627

Num loaded files 2829
Number of Recordings Found: 332
Num files after separating by cameras: 986
Num files after filtering by camera mode: 655
Num Files after filtering by label: 627
Starting Preprocessing...
Num Files after splitting by participant: 54
Num Files after removing already processed: 0
Preprocessing dataset...
Total Number of raw files preprocessed: 627

Num loaded files 324
Number of Recordings Found: 332
Num files after separating by cameras: 986
Num files after filtering by camera mode: 655
Num Files after filtering by label: 627
Starting Preprocessing...
Num Files after splitting by participant: 81
Num Files after removing already processed: 1
Preprocessing dataset...
Total Number of raw files preprocessed: 627

Num loaded files 445

====Training Epoch: 0====
[0,   100] loss: 0.994
[0,   200] loss: 0.976
[0,   300] loss: 0.947
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch0.pth

 ====Validing===
validation loss:  0.8872195598555774
Update best model! Best epoch: 0

====Training Epoch: 1====
[1,   100] loss: 0.896
[1,   200] loss: 0.884
[1,   300] loss: 0.855
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch1.pth

 ====Validing===
validation loss:  0.8317409506658229
Update best model! Best epoch: 1

====Training Epoch: 2====
[2,   100] loss: 0.812
[2,   200] loss: 0.792
[2,   300] loss: 0.766
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch2.pth

 ====Validing===
validation loss:  0.7930056852538411
Update best model! Best epoch: 2

====Training Epoch: 3====
[3,   100] loss: 0.712
[3,   200] loss: 0.707
[3,   300] loss: 0.676
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch3.pth

 ====Validing===
validation loss:  0.8206904719515544

====Training Epoch: 4====
[4,   100] loss: 0.642
[4,   200] loss: 0.630
[4,   300] loss: 0.614
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch4.pth

 ====Validing===
validation loss:  0.7430040698225905
Update best model! Best epoch: 4

====Training Epoch: 5====
[5,   100] loss: 0.577
[5,   200] loss: 0.565
[5,   300] loss: 0.551
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch5.pth

 ====Validing===
validation loss:  0.7760660699227961

====Training Epoch: 6====
[6,   100] loss: 0.524
[6,   200] loss: 0.542
[6,   300] loss: 0.524
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch6.pth

 ====Validing===
validation loss:  0.7175076669309197
Update best model! Best epoch: 6

====Training Epoch: 7====
[7,   100] loss: 0.511
[7,   200] loss: 0.517
[7,   300] loss: 0.519
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch7.pth

 ====Validing===
validation loss:  0.7845643904150986

====Training Epoch: 8====
[8,   100] loss: 0.496
[8,   200] loss: 0.536
[8,   300] loss: 0.503
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch8.pth

 ====Validing===
validation loss:  0.7415466592079256

====Training Epoch: 9====
[9,   100] loss: 0.482
[9,   200] loss: 0.535
[9,   300] loss: 0.500
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch9.pth

 ====Validing===
validation loss:  0.7261346665824332

====Training Epoch: 10====
[10,   100] loss: 0.511
[10,   200] loss: 0.474
[10,   300] loss: 0.495
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch10.pth

 ====Validing===
validation loss:  0.6614418931123687
Update best model! Best epoch: 10

====Training Epoch: 11====
[11,   100] loss: 0.488
[11,   200] loss: 0.516
[11,   300] loss: 0.457
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch11.pth

 ====Validing===
validation loss:  0.7570691799245229

====Training Epoch: 12====
[12,   100] loss: 0.459
[12,   200] loss: 0.479
[12,   300] loss: 0.443
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch12.pth

 ====Validing===
validation loss:  0.7431620606561986

====Training Epoch: 13====
[13,   100] loss: 0.436
[13,   200] loss: 0.458
[13,   300] loss: 0.462
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch13.pth

 ====Validing===
validation loss:  0.7521696265150861

====Training Epoch: 14====
[14,   100] loss: 0.441
[14,   200] loss: 0.445
[14,   300] loss: 0.435
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch14.pth

 ====Validing===
validation loss:  0.6807790907417856

====Training Epoch: 15====
[15,   100] loss: 0.438
[15,   200] loss: 0.424
[15,   300] loss: 0.444
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch15.pth

 ====Validing===
validation loss:  0.6923271919169077

====Training Epoch: 16====
[16,   100] loss: 0.421
[16,   200] loss: 0.447
[16,   300] loss: 0.400
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch16.pth

 ====Validing===
validation loss:  0.7114289686447237

====Training Epoch: 17====
[17,   100] loss: 0.390
[17,   200] loss: 0.411
[17,   300] loss: 0.391
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch17.pth

 ====Validing===
validation loss:  0.6488068350931493
Update best model! Best epoch: 17

====Training Epoch: 18====
[18,   100] loss: 0.381
[18,   200] loss: 0.372
[18,   300] loss: 0.375
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch18.pth

 ====Validing===
validation loss:  0.673235263766312

====Training Epoch: 19====
[19,   100] loss: 0.364
[19,   200] loss: 0.362
[19,   300] loss: 0.374
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch19.pth

 ====Validing===
validation loss:  0.6743259902407484

====Training Epoch: 20====
[20,   100] loss: 0.339
[20,   200] loss: 0.354
[20,   300] loss: 0.333
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch20.pth

 ====Validing===
validation loss:  0.6906715493376662

====Training Epoch: 21====
[21,   100] loss: 0.321
[21,   200] loss: 0.331
[21,   300] loss: 0.325
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch21.pth

 ====Validing===
validation loss:  0.7075503962795909

====Training Epoch: 22====
[22,   100] loss: 0.316
[22,   200] loss: 0.310
[22,   300] loss: 0.307
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch22.pth

 ====Validing===
validation loss:  0.6913672889151224

====Training Epoch: 23====
[23,   100] loss: 0.282
[23,   200] loss: 0.279
[23,   300] loss: 0.294
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch23.pth

 ====Validing===
validation loss:  0.6582192306111498

====Training Epoch: 24====
[24,   100] loss: 0.274
[24,   200] loss: 0.271
[24,   300] loss: 0.277
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch24.pth

 ====Validing===
validation loss:  0.6483725992644706
Update best model! Best epoch: 24

====Training Epoch: 25====
[25,   100] loss: 0.254
[25,   200] loss: 0.242
[25,   300] loss: 0.263
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch25.pth

 ====Validing===
validation loss:  0.6655032503895644

====Training Epoch: 26====
[26,   100] loss: 0.240
[26,   200] loss: 0.247
[26,   300] loss: 0.236
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch26.pth

 ====Validing===
validation loss:  0.6586234482323251

====Training Epoch: 27====
[27,   100] loss: 0.243
[27,   200] loss: 0.232
[27,   300] loss: 0.228
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch27.pth

 ====Validing===
validation loss:  0.6545100720917306

====Training Epoch: 28====
[28,   100] loss: 0.230
[28,   200] loss: 0.228
[28,   300] loss: 0.232
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch28.pth

 ====Validing===
validation loss:  0.6552969566205653

====Training Epoch: 29====
[29,   100] loss: 0.224
[29,   200] loss: 0.224
[29,   300] loss: 0.224
Saved Model Path:  runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch29.pth

 ====Validing===
validation loss:  0.6512315564039277
best trained epoch: 24, min_val_loss: 0.6483725992644706

===Testing===
Testing uses best epoch selected using model selection as non-pretrained model!
runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/PreTrainedModels/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_Epoch24.pth
Running model evaluation on the testing dataset!

Calculating metrics!
FFT MAE (FFT Label): 7.294921875 +/- 1.4230073046359393
FFT RMSE (FFT Label): 14.670101168231009 +/- 8.62331720544886
FFT MAPE (FFT Label): 8.413684093609653 +/- 1.6603647069484386
FFT Pearson (FFT Label): 0.3650138424209648 +/- 0.10541522872280149
FFT SNR (FFT Label): -0.5003711581700527 +/- 0.7047044632754791 (dB)
Saved NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_FFT_BlandAltman_ScatterPlot.pdf to runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/bland_altman_plots.
Saved NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_FFT_BlandAltman_DifferencePlot.pdf to runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/bland_altman_plots.
Saving outputs to: runs/exp/NECKFLIX_SizeW96_SizeH96_ClipLength128_DataTypeDiffNormalized_DataAugNone_LabelTypeDiffNormalized_Crop_faceTrue_BackendHC_Large_boxTrue_Large_size1.5_Dyamic_DetFalse_det_len30_Median_face_boxFalse/saved_test_outputs/NECKFLIX_NECKFLIX_NECKFLIX_PhysMamba_outputs.pickle
PhysMamba Complete
End Time: Wed Feb 12 11:17:12 AWST 2025
